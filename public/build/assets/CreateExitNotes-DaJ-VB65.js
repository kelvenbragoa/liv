import{s as te}from"./index-DoC7UYzi.js";import{s as oe}from"./index-BSkbeFP_.js";import{s as se}from"./index-LL0I_Z4d.js";import{s as le}from"./index-Dt5zQc2x.js";import{s as ae}from"./index-Ds2kJ9vy.js";import{s as re}from"./index-BF2pvrn1.js";import{s as ie}from"./index-BL8whLvU.js";import{u as ne,r as a,w as de,b as ue,c as T,d as t,a as s,e as r,f as l,j as _,n as y,t as u,k as ce,l as me,F as pe,i as fe,o as S,g as c}from"./app-Drk_5XQY.js";import{u as ve}from"./vee-validate-DLJ77jm2.js";import{d as _e}from"./moment-CQ1ixRO1.js";import{c as ye,a as g}from"./index.esm-CQT6nZnd.js";import"./index-BF9E9MWy.js";import"./index-_pJHyPEn.js";import"./index-r8XGnFVE.js";import"./index-mXKRTY63.js";import"./index-C2P93IIq.js";import"./index-f6DqpeBv.js";import"./index-oTLrlskW.js";import"./index-CcQDqxf6.js";import"./index-BgUkXx9t.js";import"./index-BiTvvaQ4.js";import"./index-fdgYhkeD.js";import"./index-DS2d0xJd.js";import"./index-DwXDjz3X.js";import"./index-BSRYCSE3.js";import"./index-Jd5XaIgi.js";import"./index-DAOrzEr_.js";const ge={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},xe={class:"w-full"},be={class:"flex flex-col gap-4 text-center"},ke={key:1,class:"flex flex-col md:flex-row gap-12"},he={class:"w-full"},Se={class:"card flex flex-col gap-4"},Ve={class:"w-full"},Ce={class:"flex flex-col gap-2"},we={id:"reference-help",class:"p-error"},De={class:"flex flex-col gap-2"},$e={id:"document_reference-help",class:"p-error"},qe={class:"flex flex-col gap-2"},Be={id:"serie-help",class:"p-error"},Ne={class:"flex flex-col gap-2"},Ue={id:"stock_supplier_id-help",class:"p-error"},Fe={class:"flex flex-col gap-2"},Te={id:"stock_center_id-help",class:"p-error"},ut={__name:"CreateExitNotes",setup(Ee){const V=fe(),m=ne();a(null);const x=a(!0),C=a(!1),w=a(!1);let E=a(null);const P=a(""),Q=a(null),W=a(1);a(15),a(0);const D=a(!1);a(null);const f=a(!1),j=a([]),L=a([]),$=a([]),G=ye({reference:g().required().trim().label("Codigo"),stock_center_id:g().required().trim().label("CentrodeStock"),document_reference:g().required().trim().label("Documente"),serie:g().required().trim().label("serie"),stock_supplier_id:g().required().trim().label("CentrodeStock")}),{defineField:v,handleSubmit:H,resetForm:Pe,errors:d,setErrors:K}=ve({validationSchema:G}),[b]=v("stock_center_id"),[q]=v("document_reference"),[B]=v("serie"),[N]=v("stock_supplier_id"),[U]=v("reference"),R=a();function z(){V&&V.back()}const I=()=>{D.value=!1},F=H(n=>{const e=$.value.map(i=>({id:i.id,product_id:i.product.id,stock_center_id:i.stock_center_id,quantity:i.transferQuantity}));n.stockcenterproducts=e,R.value!=null&&(n.image=R.value),f.value=!0,axios.post("/api/exitnotes",n,{headers:{"Content-Type":"multipart/form-data"}}).then(i=>{V.back(),m.add({severity:"success",summary:"Successo",detail:"Criado com sucesso",life:3e3})}).catch(i=>{f.value=!1,m.add({severity:"error",summary:"Erro",detail:`${i.response.data.message}`,life:3e3}),i.response.data.errors&&K(i.response.data.errors)}).finally(()=>{f.value=!1})}),M=async(n=1)=>{axios.get("/api/exitnotes/create",{params:{query:P.value}}).then(e=>{j.value=e.data.stockcenters,L.value=e.data.suppliers,x.value=!1}).catch(e=>{x.value=!1,m.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),z()})},O=()=>{C.value=!0,axios.delete(`/api/exitnotes/${E.value}`).then(()=>{Q.value.data=Q.value.data.filter(n=>n.id!==E.value),I(),m.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(n=>{m.add({severity:"error",summary:"Erro",detail:`${n}`,life:3e3}),C.value=!1}).finally(()=>{C.value=!1})},J=n=>{w.value=!0,axios.get(`/api/auxiliar-product/${n}`).then(e=>{$.value=e.data.stockcenterproducts,w.value=!1}).catch(e=>{m.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),w.value=!1})},X=_e(()=>{M(W.value)},300);return de(P,X),ue(()=>{M()}),(n,e)=>{const i=ie,k=re,h=ae,A=le,p=se,Y=oe,Z=te;return S(),T(pe,null,[x.value?(S(),T("div",ge,[t("div",xe,[t("div",be,[s(i,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[8]||(e[8]=t("p",null,"Por Favor Aguarde...",-1))])])])):(S(),T("div",ke,[t("div",he,[t("div",Se,[t("div",Ve,[s(k,{label:"Voltar",class:"mr-2 mb-2",onClick:z},{default:r(()=>e[9]||(e[9]=[t("i",{class:"pi pi-angle-left"},null,-1),c(" Voltar")])),_:1})]),e[19]||(e[19]=t("div",{class:"font-semibold text-xl"},"Nota de Saída de Stock",-1)),e[20]||(e[20]=t("small",{class:"p-error"},"Os campos marcados * sao considerados campos obrigatorios.",-1)),t("form",{onSubmit:e[6]||(e[6]=(...o)=>l(F)&&l(F)(...o))},[t("div",Ce,[e[10]||(e[10]=t("label",{for:"reference"},"REF",-1)),s(h,{modelValue:l(U),"onUpdate:modelValue":e[0]||(e[0]=o=>_(U)?U.value=o:null),id:"reference",placeholder:"Referencia",class:y({"p-invalid":l(d).reference}),type:"text"},null,8,["modelValue","class"]),t("small",we,u(l(d).reference),1)]),t("div",De,[e[11]||(e[11]=t("label",{for:"document_reference"},"Documento",-1)),s(h,{modelValue:l(q),"onUpdate:modelValue":e[1]||(e[1]=o=>_(q)?q.value=o:null),id:"document_reference",placeholder:"Documento",class:y({"p-invalid":l(d).document_reference}),type:"text"},null,8,["modelValue","class"]),t("small",$e,u(l(d).document_reference),1)]),t("div",qe,[e[12]||(e[12]=t("label",{for:"serie"},"Serie",-1)),s(h,{modelValue:l(B),"onUpdate:modelValue":e[2]||(e[2]=o=>_(B)?B.value=o:null),id:"serie",placeholder:"Serie",class:y({"p-invalid":l(d).serie}),type:"text"},null,8,["modelValue","class"]),t("small",Be,u(l(d).serie),1)]),t("div",Ne,[e[13]||(e[13]=t("label",{for:"stock_supplier_id"},"Supplier",-1)),s(A,{modelValue:l(N),"onUpdate:modelValue":e[3]||(e[3]=o=>_(N)?N.value=o:null),options:L.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar",class:y({"p-invalid":l(d).stock_supplier_id})},null,8,["modelValue","options","class"]),t("small",Ue,u(l(d).stock_supplier_id),1)]),t("div",Fe,[e[14]||(e[14]=t("label",{for:"stock_center_id"},"Centro de Sock ",-1)),s(A,{modelValue:l(b),"onUpdate:modelValue":e[4]||(e[4]=o=>_(b)?b.value=o:null),options:j.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar",class:y({"p-invalid":l(d).stock_center_id}),onChange:e[5]||(e[5]=o=>J(l(b)))},null,8,["modelValue","options","class"]),t("small",Te,u(l(d).stock_center_id),1)]),e[18]||(e[18]=t("hr",null,null,-1)),s(Y,{value:$.value,dataKey:"id",rowHover:!0,loading:x.value,showGridlines:""},{header:r(()=>e[15]||(e[15]=[])),empty:r(()=>e[16]||(e[16]=[c("Nenhuma registro encontrado. ")])),loading:r(()=>e[17]||(e[17]=[c(" Carregando, por favor espere. ")])),default:r(()=>[s(p,{header:"ID",style:{"min-width":"12rem"}},{body:r(({data:o})=>[c(u(o.id),1)]),_:1}),s(p,{header:"Nome",style:{"min-width":"12rem"}},{body:r(({data:o})=>[c(u(o.product.name),1)]),_:1}),s(p,{header:"Categoria",style:{"min-width":"12rem"}},{body:r(({data:o})=>[c(u(o.product.category.name),1)]),_:1}),s(p,{header:"SubCategoria",style:{"min-width":"12rem"}},{body:r(({data:o})=>[c(u(o.product.subcategory.name),1)]),_:1}),s(p,{header:"Stock Atual",style:{"min-width":"12rem"}},{body:r(({data:o})=>[c(u(o.quantity),1)]),_:1}),s(p,{header:"Quantidade",dataType:"number",style:{"min-width":"10rem"}},{body:r(({data:o})=>[s(h,{modelValue:o.transferQuantity,"onUpdate:modelValue":ee=>o.transferQuantity=ee,placeholder:"Quantidade",min:0,max:o.quantity,type:"number",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","max"])]),_:1})]),_:1},8,["value","loading"]),s(k,{label:"Submeter",class:"mr-2 mb-2 mt-2",onClick:l(F),disabled:f.value},null,8,["onClick","disabled"]),f.value?(S(),ce(i,{key:0,style:{width:"35px",height:"35px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})):me("",!0)],32)])])])),s(Z,{header:"Confirmação",visible:D.value,"onUpdate:visible":e[7]||(e[7]=o=>D.value=o),style:{width:"350px"},modal:!0},{footer:r(()=>[s(k,{label:"Não",icon:"pi pi-times",onClick:I,class:"p-button-text"}),s(k,{label:"Sim",icon:"pi pi-check",onClick:O,class:"p-button-text",autofocus:""})]),default:r(()=>[e[21]||(e[21]=t("div",{class:"flex align-items-center justify-content-center"},[t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),t("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"])],64)}}};export{ut as default};
