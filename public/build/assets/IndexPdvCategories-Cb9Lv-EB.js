import{s as Y}from"./index-ChpK7CEE.js";import{s as Z}from"./index-BGfFvUok.js";import{s as ee,a as te,b as ae}from"./index-D12n376d.js";import{s as se,a as le}from"./index-A5zeYgcn.js";import{s as oe}from"./index-C-b3TzE7.js";import{s as ie}from"./index-BXlgmuzs.js";import{u as ne,r as l,w as re,d as ue,c as o,b as t,a as n,g as k,t as d,l as M,F as p,N as g,e as r,o as a,k as w,i as de}from"./app-CTLQrJ3V.js";import{d as ce}from"./moment-CQ1ixRO1.js";import"./index-Cb5f9LtL.js";import"./index-ChSeYl5S.js";import"./index-BQLASpwo.js";import"./index-DnqLojy5.js";import"./index-B_0e6wfY.js";import"./index-cBpcpxvB.js";import"./index-BjEpkM8f.js";import"./index-CJ2bkinR.js";const pe={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},me={class:"w-full"},ve={class:"flex flex-col gap-4 text-center"},fe={key:1},_e={class:"grid grid-cols-12 gap-4 h-screen"},be={class:"col-span-12 lg:col-span-3 h-full"},ge={class:"card flex flex-col gap-4 h-full"},he={key:0},xe=["onClick"],ye={class:"flex justify-between mb-4"},ke={key:0,class:"mt-4"},we=["disabled"],Ce={key:0,class:"flex flex-col gap-4 text-center"},Te={class:"col-span-12 lg:col-span-9"},$e={class:"mb-2"},De={class:"card flex flex-col gap-4"},Pe={key:0},Be={class:"grid grid-cols-12 gap-8"},Me={class:"card mb-0 bg-gray-100"},qe={class:"mb-4"},Se=["src"],je={class:"flex justify-between mb-4"},Fe={class:"text-surface-900 dark:text-surface-0 font-medium text-xl"},Ne={class:"flex justify-between mb-4"},Le={class:"text-primary font-medium"},Re=["onClick"],Ae={key:1},st={__name:"IndexPdvCategories",setup(Ee){const h=de(),x=ne();l(null);const C=l(!0),T=l(!1);let q=l(null);const S=l(""),$=l(null),z=l(1);l(15),l(0);const D=l(!1),P=l(null),m=l([]),v=l(0),j=l(0),y=l(!1),O=l(!1),c=l(!1),W=[{label:"Consumo",items:[{label:"Ver consumo",icon:"pi pi-fw pi-folder-open",command:()=>{c.value=!0}},{label:"Imprimir Consumo",icon:"pi pi-fw pi-print",command:()=>{c.value=!0}}]},{label:"Opções",items:[{label:"Agrupar Mesa",icon:"pi pi-fw pi-folder-open",command:()=>{c.value=!0}}]},{label:"Conta",items:[{label:"Fechamento da Conta",icon:"pi pi-fw pi-lock",command:()=>{c.value=!0}},{label:"Finalizar da Conta",icon:"pi pi-fw pi-check",command:()=>{c.value=!0}}]}];function H(){h&&h.back()}const F=()=>{D.value=!1};function Q(){const i={products:m.value.map(e=>({id:e.id,name:e.name,quantity:e.quantity,total:e.price*e.quantity})),total:v.value,table_id:h.currentRoute.value.params.id};y.value=!0,axios.post("/api/pdv",i,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob"}).then(e=>{h.back();const f=window.URL.createObjectURL(new Blob([e.data])),_=document.createElement("a");_.href=f,_.setAttribute("download","recibo.pdf"),document.body.appendChild(_),_.click(),O.value=!1,x.add({severity:"success",summary:"Successo",detail:"Produto encomedado sucesso!",life:3e3})}).catch(e=>{y.value=!1,x.add({severity:"error",summary:"Erro}",detail:`${e}`,life:3e3}),e.response.data.errors&&setErrors(e.response.data.errors)}).finally(()=>{y.value=!1})}function X(i){const e=m.value.find(f=>f.id===i.id);e?e.quantity+=1:m.value.push({...i,quantity:1}),N()}function G(i){m.value.splice(i,1),N()}function N(){v.value=m.value.reduce((i,e)=>i+e.price*e.quantity,0)}const L=async(i=1)=>{axios.get(`/api/pdv/${h.currentRoute.value.params.id}`,{params:{query:S.value}}).then(e=>{$.value=e.data,j.value=e.data.total_consumed,P.value=e.data.categories,C.value=!1}).catch(e=>{C.value=!1,x.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),H()})},J=()=>{T.value=!0,axios.delete(`/api/tables/${q.value}`).then(()=>{$.value.data=$.value.data.filter(i=>i.id!==q.value),F(),x.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(i=>{x.add({severity:"error",summary:"Erro",detail:`${i}`,life:3e3}),T.value=!1}).finally(()=>{T.value=!1})},K=ce(()=>{L(z.value)},300);return re(S,K),ue(()=>{L()}),(i,e)=>{const f=ie,_=oe,R=te,A=ae,E=se,U=le,V=ee,B=Z,I=Y;return a(),o(p,null,[C.value?(a(),o("div",pe,[t("div",me,[t("div",ve,[n(f,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[3]||(e[3]=t("p",null,"Por Favor Aguarde...",-1))])])])):(a(),o("div",fe,[t("div",_e,[t("div",be,[t("div",ge,[t("h2",null,[e[4]||(e[4]=k("Resumo da venda ")),v.value>0?(a(),o("div",he,[t("strong",null,"Total: "+d(v.value)+" MT",1)])):M("",!0)]),(a(!0),o(p,null,g(m.value,(s,u)=>(a(),o("div",{key:u,class:"card bg-gray-100 p-4"},[t("div",null,[t("strong",null,d(s.name),1),t("button",{onClick:b=>G(u),class:"rounded-full bg-red-100",style:{width:"2.5rem",height:"2.5rem"}},"X",8,xe)]),t("div",ye,[t("div",null,d(s.quantity)+" x "+d(s.price)+" MT",1),t("div",null,d(s.price*s.quantity)+" MT",1)])]))),128)),v.value>0?(a(),o("div",ke,[t("strong",null,"Total: "+d(v.value)+" MT",1),t("button",{disabled:y.value,onClick:Q,class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1",style:{width:"100%"}},e[5]||(e[5]=[k("Adicionar a conta"),t("i",{class:"pi pi-print"},null,-1)]),8,we),y.value?(a(),o("div",Ce,[n(f,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])):M("",!0)])):M("",!0)])]),t("div",Te,[t("div",$e,[n(_,{model:W},{end:r(()=>[t("p",null,"Total Consumo: "+d(j.value)+" MT",1)]),_:1})]),t("div",De,[n(V,{value:1},{default:r(()=>[n(A,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:r(()=>[(a(!0),o(p,null,g(P.value,s=>(a(),w(R,{key:s.id,value:s.id},{default:r(()=>[k(d(s.name),1)]),_:2},1032,["value"]))),128))]),_:1}),n(U,null,{default:r(()=>[(a(!0),o(p,null,g(P.value,s=>(a(),w(E,{key:s.id,value:s.id},{default:r(()=>[n(V,{value:0},{default:r(()=>[n(A,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:r(()=>[(a(!0),o(p,null,g(s.sub_categories,u=>(a(),w(R,{key:u.id,value:u.id},{default:r(()=>[k(d(u.name),1)]),_:2},1032,["value"]))),128))]),_:2},1024),n(U,null,{default:r(()=>[(a(!0),o(p,null,g(s.sub_categories,u=>(a(),w(E,{key:u.id,value:u.id},{default:r(()=>[u.products.length>0?(a(),o("div",Pe,[t("div",Be,[(a(!0),o(p,null,g(u.products,b=>(a(),o("div",{key:b.id,class:"col-span-12 lg:col-span-6 xl:col-span-3"},[t("div",Me,[t("div",qe,[t("img",{src:b.image_url||"/image/image.png",alt:"Imagem do Produto",class:"w-full h-32 object-cover rounded-t-lg"},null,8,Se)]),t("div",je,[t("div",null,[t("div",Fe,d(b.name),1)])]),t("div",Ne,[t("span",Le,"Preço: "+d(b.price)+" MT",1)]),t("button",{onClick:Ue=>X(b),class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1"}," Adicionar ",8,Re)])]))),128))])])):(a(),o("div",Ae,e[6]||(e[6]=[t("p",null,"No products available.",-1)])))]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])])])])),n(I,{header:"Confirmação",visible:D.value,"onUpdate:visible":e[0]||(e[0]=s=>D.value=s),style:{width:"350px"},modal:!0},{footer:r(()=>[n(B,{label:"Não",icon:"pi pi-times",onClick:F,class:"p-button-text"}),n(B,{label:"Sim",icon:"pi pi-check",onClick:J,class:"p-button-text",autofocus:""})]),default:r(()=>[e[7]||(e[7]=t("div",{class:"flex align-items-center justify-content-center"},[t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),t("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"]),n(I,{header:"Open File",visible:c.value,"onUpdate:visible":e[2]||(e[2]=s=>c.value=s),style:{width:"30vw"}},{default:r(()=>[e[8]||(e[8]=t("p",null,"Here you can manage your files or perform specific actions.",-1)),n(B,{label:"Close",onClick:e[1]||(e[1]=s=>c.value=!1)})]),_:1},8,["visible"])],64)}}};export{st as default};
