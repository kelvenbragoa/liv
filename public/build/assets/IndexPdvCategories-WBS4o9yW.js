import{s as G}from"./index-DSAyAkhN.js";import{s as H}from"./index-TdpNRn00.js";import{s as J,a as K,b as O}from"./index-DXztDLKS.js";import{s as Y,a as Z}from"./index-fxcQQJlH.js";import{s as ee}from"./index-VTH343q4.js";import{u as te,r as o,w as se,d as ae,c as l,b as e,a as u,g as y,t as d,l as P,F as c,N as v,e as n,o as s,k as b,i as le}from"./app-CKonVDLw.js";import{d as oe}from"./moment-CQ1ixRO1.js";import"./index-fRqD7eZQ.js";import"./index-B-SFtyIt.js";import"./index-BQHiY-eb.js";import"./index-BAGbMNE0.js";import"./index-DQHd58qN.js";const ie={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},ne={class:"w-full"},re={class:"flex flex-col gap-4 text-center"},ue={key:1},de={class:"grid grid-cols-12 gap-4 h-screen"},ce={class:"col-span-12 lg:col-span-3 h-full"},pe={class:"card flex flex-col gap-4 h-full"},ve={key:0},me=["onClick"],fe={class:"flex justify-between mb-4"},_e={key:0,class:"mt-4"},ge=["disabled"],he={key:0,class:"flex flex-col gap-4 text-center"},xe={class:"col-span-12 lg:col-span-9"},ye={class:"card flex flex-col gap-4"},be={key:0},ke={class:"grid grid-cols-12 gap-8"},Ce={class:"card mb-0 bg-gray-100"},Te={class:"mb-4"},we=["src"],$e={class:"flex justify-between mb-4"},Pe={class:"text-surface-900 dark:text-surface-0 font-medium text-xl"},De={class:"flex justify-between mb-4"},Be={class:"text-primary font-medium"},qe=["onClick"],Se={key:1},Xe={__name:"IndexPdvCategories",setup(je){const h=le(),m=te();o(null);const k=o(!0),C=o(!1);let D=o(null);const B=o(""),T=o(null),L=o(1);o(15);const V=o(0),w=o(!1),$=o(null),f=o([]),_=o(0),g=o(!1);function A(){h&&h.back()}const q=()=>{w.value=!1};function I(){const i={products:f.value.map(t=>({id:t.id,name:t.name,quantity:t.quantity,total:t.price*t.quantity})),total:_.value,table_id:h.currentRoute.value.params.id};g.value=!0,axios.post("/api/pdv",i,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{m.add({severity:"success",summary:"Successo",detail:"Produto encomedado sucesso!",life:3e3})}).catch(t=>{g.value=!1,m.add({severity:"error",summary:"Erro}",detail:`${t.response.data.message}`,life:3e3}),t.response.data.errors&&setErrors(t.response.data.errors)}).finally(()=>{g.value=!1})}function z(i){const t=f.value.find(x=>x.id===i.id);t?t.quantity+=1:f.value.push({...i,quantity:1}),this.updateTotal()}function U(i){f.value.splice(i,1),this.updateTotal()}const S=async(i=1)=>{axios.get(`/api/pdv/${h.currentRoute.value.params.id}`,{params:{query:B.value}}).then(t=>{T.value=t.data,V.value=t.data.total,$.value=t.data.categories,k.value=!1}).catch(t=>{k.value=!1,m.add({severity:"error",summary:`${t}`,detail:"Message Detail",life:3e3}),A()})},W=()=>{C.value=!0,axios.delete(`/api/tables/${D.value}`).then(()=>{T.value.data=T.value.data.filter(i=>i.id!==D.value),q(),m.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(i=>{m.add({severity:"error",summary:"Erro",detail:`${i}`,life:3e3}),C.value=!1}).finally(()=>{C.value=!1})},Q=oe(()=>{S(L.value)},300);return se(B,Q),ae(()=>{S()}),(i,t)=>{const x=ee,j=K,M=O,N=Y,R=Z,E=J,F=H,X=G;return s(),l(c,null,[k.value?(s(),l("div",ie,[e("div",ne,[e("div",re,[u(x,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),t[1]||(t[1]=e("p",null,"Por Favor Aguarde...",-1))])])])):(s(),l("div",ue,[e("div",de,[e("div",ce,[e("div",pe,[e("h2",null,[t[2]||(t[2]=y("Resumo da venda ")),_.value>0?(s(),l("div",ve,[e("strong",null,"Total: "+d(_.value)+" MT",1)])):P("",!0)]),(s(!0),l(c,null,v(f.value,(a,r)=>(s(),l("div",{key:r,class:"card bg-gray-100 p-4"},[e("div",null,[e("strong",null,d(a.name),1),e("button",{onClick:p=>U(r),class:"rounded-full bg-red-100",style:{width:"2.5rem",height:"2.5rem"}},"X",8,me)]),e("div",fe,[e("div",null,d(a.quantity)+" x "+d(a.price)+" MT",1),e("div",null,d(a.price*a.quantity)+" MT",1)])]))),128)),_.value>0?(s(),l("div",_e,[e("strong",null,"Total: "+d(_.value)+" MT",1),e("button",{disabled:g.value,onClick:I,class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1",style:{width:"100%"}},t[3]||(t[3]=[y("Adicionar a conta"),e("i",{class:"pi pi-print"},null,-1)]),8,ge),g.value?(s(),l("div",he,[u(x,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])):P("",!0)])):P("",!0)])]),e("div",xe,[e("div",ye,[u(E,{value:1},{default:n(()=>[u(M,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:n(()=>[(s(!0),l(c,null,v($.value,a=>(s(),b(j,{key:a.id,value:a.id},{default:n(()=>[y(d(a.name),1)]),_:2},1032,["value"]))),128))]),_:1}),u(R,null,{default:n(()=>[(s(!0),l(c,null,v($.value,a=>(s(),b(N,{key:a.id,value:a.id},{default:n(()=>[u(E,{value:0},{default:n(()=>[u(M,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:n(()=>[(s(!0),l(c,null,v(a.sub_categories,r=>(s(),b(j,{key:r.id,value:r.id},{default:n(()=>[y(d(r.name),1)]),_:2},1032,["value"]))),128))]),_:2},1024),u(R,null,{default:n(()=>[(s(!0),l(c,null,v(a.sub_categories,r=>(s(),b(N,{key:r.id,value:r.id},{default:n(()=>[r.products.length>0?(s(),l("div",be,[e("div",ke,[(s(!0),l(c,null,v(r.products,p=>(s(),l("div",{key:p.id,class:"col-span-12 lg:col-span-6 xl:col-span-3"},[e("div",Ce,[e("div",Te,[e("img",{src:p.image_url||"/image/image.png",alt:"Imagem do Produto",class:"w-full h-32 object-cover rounded-t-lg"},null,8,we)]),e("div",$e,[e("div",null,[e("div",Pe,d(p.name),1)])]),e("div",De,[e("span",Be,"Preço: "+d(p.price)+" MT",1)]),e("button",{onClick:Me=>z(p),class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1"}," Adicionar ",8,qe)])]))),128))])])):(s(),l("div",Se,t[4]||(t[4]=[e("p",null,"No products available.",-1)])))]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])])])])),u(X,{header:"Confirmação",visible:w.value,"onUpdate:visible":t[0]||(t[0]=a=>w.value=a),style:{width:"350px"},modal:!0},{footer:n(()=>[u(F,{label:"Não",icon:"pi pi-times",onClick:q,class:"p-button-text"}),u(F,{label:"Sim",icon:"pi pi-check",onClick:W,class:"p-button-text",autofocus:""})]),default:n(()=>[t[5]||(t[5]=e("div",{class:"flex align-items-center justify-content-center"},[e("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),e("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"])],64)}}};export{Xe as default};
