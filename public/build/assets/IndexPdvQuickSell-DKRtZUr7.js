import{s as se}from"./index-qXUTzdOx.js";import{s as oe}from"./index-CORwN7jQ.js";import{s as ie,a as ne,b as re}from"./index-Cvu2dNwT.js";import{s as ue,a as de}from"./index-BDfkQj70.js";import{s as ce}from"./index-BUxeSNZt.js";import{s as pe}from"./index-COqPftqn.js";import{s as me}from"./index-BTpf2uCp.js";import{u as ve,r as s,w as fe,b as _e,c as n,d as t,a as i,g as w,t as d,l as C,F as p,a1 as _,e as r,o as l,k as T,i as be}from"./app-vYUSM3WH.js";import"./index.esm-CQT6nZnd.js";import{d as ge}from"./moment-CQ1ixRO1.js";import"./index-CANkx4T-.js";import"./index-CztwITzX.js";import"./index-DhWyYE7j.js";import"./index-B26h3KPN.js";import"./index-CN0qabK-.js";import"./index-SYVZSIUZ.js";import"./index-CIy5AIpj.js";import"./index-OOuWSvRy.js";import"./index-HUIxTbDJ.js";import"./index-DDNpWD7N.js";import"./index-CGiVpY5D.js";import"./index-JNaSvpna.js";const ye={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},he={class:"w-full"},xe={class:"flex flex-col gap-4 text-center"},ke={key:1},we={class:"grid grid-cols-12 gap-4 h-screen"},Ce={class:"col-span-12 lg:col-span-3 h-full"},Te={class:"card flex flex-col gap-4 h-full"},De={key:0},$e=["onClick"],Pe={class:"flex justify-between mb-4"},qe={key:0,class:"mt-4"},Se=["disabled"],Be={key:0,class:"flex flex-col gap-4 text-center"},Me={class:"col-span-12 lg:col-span-9"},Ve={class:"mb-2"},Fe={class:"card flex flex-col gap-4"},Ue={key:0},je={class:"grid grid-cols-12 gap-8"},Le={class:"card mb-0 bg-gray-100"},Ne={class:"mb-4"},Ie=["src"],Re={class:"flex justify-between mb-4"},Ee={class:"text-surface-900 dark:text-surface-0 font-medium text-xl"},We={class:"flex justify-between mb-4"},Ae={class:"text-primary font-medium"},ze=["onClick"],Oe={key:1},Qe=["src"],bt={__name:"IndexPdvQuickSell",setup(He){const D=be(),b=ve();s(null);const $=s(!0),P=s(!1);let F=s(null);const U=s(""),q=s(null),Q=s(1);s(15),s(0);const S=s(!1),B=s(null),m=s([]),v=s(0),j=s(0),L=s([]),h=s(!1),x=s(1),k=s(!1),M=s(null),g=s(!1),H=[{label:"Consumo",items:[{label:"Ver consumo",icon:"pi pi-fw pi-folder-open",command:()=>{g.value=!0}},{label:"Imprimir Consumo",icon:"pi pi-fw pi-print",command:()=>{g.value=!0}}]}];function X(){D&&D.back()}const N=()=>{S.value=!1};function G(){const o=document.querySelector("iframe");o&&(o.contentWindow.focus(),o.contentWindow.print())}function J(){k.value=!0,D.back()}function K(){const o={products:m.value.map(e=>({id:e.id,name:e.name,quantity:e.quantity,total:e.price*e.quantity})),total:v.value,payment_method_id:x.value};h.value=!0,axios.post("/api/pdv/quicksell",o,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob"}).then(e=>{const f=new Blob([e.data],{type:"application/pdf"});M.value=URL.createObjectURL(f),k.value=!0,b.add({severity:"success",summary:"Sucesso",detail:"Produto encomendado com sucesso!",life:3e3})}).catch(e=>{console.log(e),b.add({severity:"error",summary:"Erro",detail:e.response.data.message,life:3e3}),e.response.data.errors&&setErrors(e.response.data.errors)}).finally(()=>{h.value=!1})}function Y(o){const e=m.value.find(f=>f.id===o.id);e?e.quantity+=1:m.value.push({...o,quantity:1}),I()}function Z(o){m.value.splice(o,1),I()}function I(){v.value=m.value.reduce((o,e)=>o+e.price*e.quantity,0)}const R=async(o=1)=>{axios.get("/api/pdv/quicksell",{params:{query:U.value}}).then(e=>{q.value=e.data,j.value=e.data.total_consumed,B.value=e.data.categories,L.value=e.data.payment_methods,x.value=1,$.value=!1}).catch(e=>{$.value=!1,b.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),X()})},ee=()=>{P.value=!0,axios.delete(`/api/tables/${F.value}`).then(()=>{q.value.data=q.value.data.filter(o=>o.id!==F.value),N(),b.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(o=>{b.add({severity:"error",summary:"Erro",detail:`${o}`,life:3e3}),P.value=!1}).finally(()=>{P.value=!1})},te=ge(()=>{R(Q.value)},300);return fe(U,te),_e(()=>{R()}),(o,e)=>{const f=me,ae=pe,le=ce,E=ne,W=re,A=ue,z=de,O=ie,y=oe,V=se;return l(),n(p,null,[$.value?(l(),n("div",ye,[t("div",he,[t("div",xe,[i(f,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[5]||(e[5]=t("p",null,"Por Favor Aguarde...",-1))])])])):(l(),n("div",ke,[t("div",we,[t("div",Ce,[t("div",Te,[t("h2",null,[e[6]||(e[6]=w("Resumo da venda ")),v.value>0?(l(),n("div",De,[t("strong",null,"Total: "+d(v.value)+" MT",1)])):C("",!0)]),(l(!0),n(p,null,_(m.value,(a,u)=>(l(),n("div",{key:u,class:"card bg-gray-100 p-4"},[t("div",null,[t("strong",null,d(a.name),1),t("button",{onClick:c=>Z(u),class:"rounded-full bg-red-100",style:{width:"2.5rem",height:"2.5rem"}},"X",8,$e)]),t("div",Pe,[t("div",null,d(a.quantity)+" x "+d(a.price)+" MT",1),t("div",null,d(a.price*a.quantity)+" MT",1)])]))),128)),v.value>0?(l(),n("div",qe,[i(ae,{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=a=>x.value=a),options:L.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar"},null,8,["modelValue","options"]),t("strong",null,"Total: "+d(v.value)+" MT",1),t("button",{disabled:h.value,onClick:K,class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1",style:{width:"100%"}},e[7]||(e[7]=[w("Adicionar a conta"),t("i",{class:"pi pi-print"},null,-1)]),8,Se),h.value?(l(),n("div",Be,[i(f,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])):C("",!0)])):C("",!0)])]),t("div",Me,[t("div",Ve,[i(le,{model:H},{end:r(()=>[t("p",null,"Total Consumo: "+d(j.value)+" MT",1)]),_:1})]),t("div",Fe,[i(O,{value:1},{default:r(()=>[i(W,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:r(()=>[(l(!0),n(p,null,_(B.value,a=>(l(),T(E,{key:a.id,value:a.id},{default:r(()=>[w(d(a.name),1)]),_:2},1032,["value"]))),128))]),_:1}),i(z,null,{default:r(()=>[(l(!0),n(p,null,_(B.value,a=>(l(),T(A,{key:a.id,value:a.id},{default:r(()=>[i(O,{value:0},{default:r(()=>[i(W,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:r(()=>[(l(!0),n(p,null,_(a.sub_categories,u=>(l(),T(E,{key:u.id,value:u.id},{default:r(()=>[w(d(u.name),1)]),_:2},1032,["value"]))),128))]),_:2},1024),i(z,null,{default:r(()=>[(l(!0),n(p,null,_(a.sub_categories,u=>(l(),T(A,{key:u.id,value:u.id},{default:r(()=>[u.products.length>0?(l(),n("div",Ue,[t("div",je,[(l(!0),n(p,null,_(u.products,c=>(l(),n("div",{key:c.id,class:"col-span-12 lg:col-span-6 xl:col-span-3"},[t("div",Le,[t("div",Ne,[t("img",{src:c.image?`/${c.image}`:"/image/image.png",alt:"Imagem do Produto",class:"w-full h-32 rounded-t-lg"},null,8,Ie)]),t("div",Re,[t("div",null,[t("div",Ee,d(c.name),1)])]),t("div",We,[t("span",Ae,"Preço: "+d(c.price)+" MT",1)]),t("button",{onClick:Xe=>Y(c),class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1"}," Adicionar ",8,ze)])]))),128))])])):(l(),n("div",Oe,e[8]||(e[8]=[t("p",null,"No products available.",-1)])))]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])])])])),i(V,{header:"Confirmação",visible:S.value,"onUpdate:visible":e[1]||(e[1]=a=>S.value=a),style:{width:"350px"},modal:!0},{footer:r(()=>[i(y,{label:"Não",icon:"pi pi-times",onClick:N,class:"p-button-text"}),i(y,{label:"Sim",icon:"pi pi-check",onClick:ee,class:"p-button-text",autofocus:""})]),default:r(()=>[e[9]||(e[9]=t("div",{class:"flex align-items-center justify-content-center"},[t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),t("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"]),i(V,{header:"Open File",visible:g.value,"onUpdate:visible":e[3]||(e[3]=a=>g.value=a),style:{width:"30vw"}},{default:r(()=>[e[10]||(e[10]=t("p",null,"Here you can manage your files or perform specific actions.",-1)),i(y,{label:"Close",onClick:e[2]||(e[2]=a=>g.value=!1)})]),_:1},8,["visible"]),i(V,{visible:k.value,"onUpdate:visible":e[4]||(e[4]=a=>k.value=a),header:"Recibo",modal:!0,style:{width:"600px"},closable:!1},{footer:r(()=>[i(y,{label:"Imprimir",icon:"pi pi-print",onClick:G}),i(y,{label:"Fechar",icon:"pi pi-times",class:"p-button-text",onClick:J})]),default:r(()=>[M.value?(l(),n("iframe",{key:0,src:M.value,style:{width:"100%",height:"500px"},frameborder:"0"},null,8,Qe)):C("",!0)]),_:1},8,["visible"])],64)}}};export{bt as default};
