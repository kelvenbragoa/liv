import{s as I}from"./index-XbGmJLMh.js";import{s as G}from"./index-BrYBxPiX.js";import{s as K}from"./index-CUFosfYI.js";import{s as O}from"./index-DLj195WP.js";import{s as Q}from"./index-bUGoavnt.js";import{s as W}from"./index-fv5UVMmX.js";import{s as J}from"./index-Br4Pc_Lc.js";import{u as X,r as o,w as Z,o as tt,c as C,a as e,b as a,e as r,d as s,t as u,g as V,F as et,f as k,k as at}from"./app-DY2v7NP-.js";import{d as ot,h as Y}from"./moment-CQ1ixRO1.js";import"./index-CagCVgjn.js";import"./index-BBM6mzT7.js";import"./index-yLmGNYJZ.js";import"./index-BHCL5yUw.js";import"./index-BbfyYLy3.js";import"./index-CyrvuwFf.js";import"./index-Xrif0CuN.js";import"./index-B5vk5uBi.js";import"./index-DGO_DEFa.js";import"./index-DE7O1HmT.js";import"./index-BeaIVxKW.js";import"./index-Wby6uIz2.js";import"./index-B19iqZNe.js";import"./index-BzqqvGpf.js";import"./index-CEGzq8ED.js";import"./index-DMuM1bL4.js";import"./index-DesHEDWE.js";import"./index-CqIkRbzy.js";const st={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},lt={class:"w-full"},rt={class:"flex flex-col gap-4 text-center"},nt={key:1,class:"flex flex-col md:flex-row gap-12"},it={class:"w-full"},ut={class:"card flex flex-col gap-4"},dt={class:"w-full"},mt={class:"card"},zt={__name:"ShowTables",setup(ct){const f=at(),v=X();o(null);const c=o(!0),g=o(!1);let D=o(null);const M=o(""),i=o(null),P=o(null),p=o(1),y=o(15),S=o(0),b=o(!1),x=getComputedStyle(document.documentElement),R=x.getPropertyValue("--surface-border"),$=x.getPropertyValue("--text-color-primary"),L=x.getPropertyValue("--p-button-primary-background"),w=o({labels:[],datasets:[{label:"Consumo Mensal",backgroundColor:L,data:[]}]}),N={maintainAspectRatio:!1,aspectRatio:.8,scales:{x:{stacked:!0,ticks:{color:$.trim()},grid:{color:"transparent",borderColor:"transparent"}},y:{stacked:!0,ticks:{color:$.trim()},grid:{color:R.trim(),borderColor:"transparent",drawTicks:!1}}}};function B(){f&&f.back()}const T=()=>{b.value=!1};function A(n){switch(n){case 1:return"success";case 2:return"danger";case 3:return"warn";case 4:return"danger";case 5:return"info";case 6:return"info"}}const h=async(n=1)=>{axios.get(`/api/tables/${f.currentRoute.value.params.id}`,{params:{query:M.value}}).then(t=>{i.value=t.data.table,P.value=t.data.logs,S.value=t.data.logs.total,w.value.labels=t.data.chart.map(d=>d.month_name),w.value.datasets[0].data=t.data.chart.map(d=>d.total),c.value=!1}).catch(t=>{c.value=!1,v.add({severity:"error",summary:`${t}`,detail:"Message Detail",life:3e3}),B()})},E=()=>{g.value=!0,axios.delete(`/api/tables/${D.value}`).then(()=>{i.value.data=i.value.data.filter(n=>n.id!==D.value),T(),v.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(n=>{v.add({severity:"error",summary:"Erro",detail:`${n}`,life:3e3}),g.value=!1}).finally(()=>{g.value=!1})},j=n=>{p.value=n.page+1,y.value=n.rows,h(p.value)},z=ot(()=>{h(p.value)},300);return Z(M,z),tt(()=>{h()}),(n,t)=>{const d=J,_=W,F=Q,H=O,m=K,U=G,q=I;return k(),C(et,null,[c.value?(k(),C("div",st,[e("div",lt,[e("div",rt,[a(d,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),t[1]||(t[1]=e("p",null,"Por Favor Aguarde...",-1))])])])):(k(),C("div",nt,[e("div",it,[e("div",ut,[e("div",dt,[a(_,{label:"Voltar",class:"mr-2 mb-2",onClick:B},{default:r(()=>t[2]||(t[2]=[e("i",{class:"pi pi-angle-left"},null,-1),s(" Voltar")])),_:1})]),t[11]||(t[11]=e("div",{class:"font-semibold text-xl"},"Mesa",-1)),e("p",null,[t[3]||(t[3]=e("strong",null,"Mesa:",-1)),s(" "+u(i.value.name),1)]),e("p",null,[t[4]||(t[4]=e("strong",null,"Capacidade:",-1)),s(" "+u(i.value.capacity),1)]),e("p",null,[t[5]||(t[5]=e("strong",null,"Limite Mensal:",-1)),s(" "+u(i.value.monthly_limit)+" MT ",1)]),e("p",null,[t[6]||(t[6]=e("strong",null,"Estado:",-1)),a(F,{value:i.value.status.name,severity:A(i.value.status_id)},null,8,["value","severity"])]),e("p",null,[t[7]||(t[7]=e("strong",null,"Data:",-1)),s(" "+u(V(Y)(i.value.created_at).format("DD-MM-YYYY H:mm")),1)]),t[12]||(t[12]=e("hr",null,null,-1)),e("div",mt,[t[8]||(t[8]=e("div",{class:"font-semibold text-xl mb-4"},"Consumo Mensal",-1)),a(H,{type:"bar",data:w.value,options:N,class:"h-80"},null,8,["data"])]),t[13]||(t[13]=e("hr",null,null,-1)),a(U,{value:P.value.data,paginator:!0,rows:y.value,totalRecords:S.value,dataKey:"id",lazy:!0,rowHover:!0,loading:c.value,first:(p.value-1)*y.value,onPage:j,showGridlines:""},{empty:r(()=>t[9]||(t[9]=[s("Nenhuma registro encontrado. ")])),loading:r(()=>t[10]||(t[10]=[s(" Carregando, por favor espere. ")])),default:r(()=>[a(m,{header:"ID",style:{"min-width":"12rem"}},{body:r(({data:l})=>[s(u(l.id),1)]),_:1}),a(m,{header:"Limite Anterior",style:{"min-width":"12rem"}},{body:r(({data:l})=>[s(u(l.old_limit),1)]),_:1}),a(m,{header:"Limite Atual",style:{"min-width":"12rem"}},{body:r(({data:l})=>[s(u(l.new_limit),1)]),_:1}),a(m,{header:"Usuario",style:{"min-width":"12rem"}},{body:r(({data:l})=>[s(u(l.user.name),1)]),_:1}),a(m,{header:"Data",dataType:"date",style:{"min-width":"10rem"}},{body:r(({data:l})=>[s(u(V(Y)(l.created_at).format("DD-MM-YYYY H:mm")),1)]),_:1})]),_:1},8,["value","rows","totalRecords","loading","first"])])])])),a(q,{header:"Confirmação",visible:b.value,"onUpdate:visible":t[0]||(t[0]=l=>b.value=l),style:{width:"350px"},modal:!0},{footer:r(()=>[a(_,{label:"Não",icon:"pi pi-times",onClick:T,class:"p-button-text"}),a(_,{label:"Sim",icon:"pi pi-check",onClick:E,class:"p-button-text",autofocus:""})]),default:r(()=>[t[14]||(t[14]=e("div",{class:"flex align-items-center justify-content-center"},[e("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),e("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"])],64)}}};export{zt as default};
