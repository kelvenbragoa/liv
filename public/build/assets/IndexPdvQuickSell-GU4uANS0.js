import{s as ee}from"./index-B9ptCq3a.js";import{s as te}from"./index-CFQgdBt-.js";import{s as ae,a as se,b as le}from"./index-CPxNRoWA.js";import{s as oe,a as ie}from"./index-C2i0oaMM.js";import{s as ne}from"./index-BEkNfJi8.js";import{s as re}from"./index-kU8Jj-Xh.js";import{s as ue}from"./index-CZLO797_.js";import{u as de,r as l,w as ce,d as pe,c as o,b as t,a as i,g as k,t as d,l as B,F as m,N as b,e as r,o as s,k as w,i as me}from"./app-hipc22d0.js";import"./index.esm-CQT6nZnd.js";import{d as ve}from"./moment-CQ1ixRO1.js";import"./index-BWujQi6O.js";import"./index-Bk8W5zav.js";import"./index-D6SvesWT.js";import"./index-Cy88WPCa.js";import"./index-BSRvUWzU.js";import"./index-TQXxgTTm.js";import"./index-9yetRwxd.js";import"./index-BIHZtbY5.js";import"./index-BwbhOCTk.js";import"./index-CUigoZBc.js";import"./index-URuiZqWx.js";import"./index-DODwoh0z.js";const fe={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},_e={class:"w-full"},be={class:"flex flex-col gap-4 text-center"},ge={key:1},ye={class:"grid grid-cols-12 gap-4 h-screen"},he={class:"col-span-12 lg:col-span-3 h-full"},xe={class:"card flex flex-col gap-4 h-full"},ke={key:0},we=["onClick"],Ce={class:"flex justify-between mb-4"},Te={key:0,class:"mt-4"},$e=["disabled"],De={key:0,class:"flex flex-col gap-4 text-center"},Pe={class:"col-span-12 lg:col-span-9"},qe={class:"mb-2"},Se={class:"card flex flex-col gap-4"},Be={key:0},Me={class:"grid grid-cols-12 gap-8"},je={class:"card mb-0 bg-gray-100"},Le={class:"mb-4"},Ve=["src"],Ue={class:"flex justify-between mb-4"},Ne={class:"text-surface-900 dark:text-surface-0 font-medium text-xl"},Fe={class:"flex justify-between mb-4"},Re={class:"text-primary font-medium"},Ee=["onClick"],Ae={key:1},pt={__name:"IndexPdvQuickSell",setup(Ie){const C=me(),g=de();l(null);const T=l(!0),$=l(!1);let M=l(null);const j=l(""),D=l(null),Q=l(1);l(15),l(0);const P=l(!1),q=l(null),v=l([]),f=l(0),L=l(0),V=l([]),h=l(!1),x=l(1),y=l(!1),W=[{label:"Consumo",items:[{label:"Ver consumo",icon:"pi pi-fw pi-folder-open",command:()=>{y.value=!0}},{label:"Imprimir Consumo",icon:"pi pi-fw pi-print",command:()=>{y.value=!0}}]}];function H(){C&&C.back()}const U=()=>{P.value=!1};function X(){const n={products:v.value.map(e=>({id:e.id,name:e.name,quantity:e.quantity,total:e.price*e.quantity})),total:f.value,payment_method_id:x.value};h.value=!0,axios.post("/api/pdv/quicksell",n,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob"}).then(e=>{const c=window.URL.createObjectURL(new Blob([e.data])),p=document.createElement("a");p.href=c,p.setAttribute("download","recibo.pdf"),document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(c),g.add({severity:"success",summary:"Sucesso",detail:"Produto encomendado com sucesso!",life:3e3}),C.back()}).catch(e=>{console.log(e),g.add({severity:"error",summary:"Erro",detail:e.response.data.message,life:3e3}),e.response.data.errors&&setErrors(e.response.data.errors)}).finally(()=>{h.value=!1})}function G(n){const e=v.value.find(c=>c.id===n.id);e?e.quantity+=1:v.value.push({...n,quantity:1}),N()}function J(n){v.value.splice(n,1),N()}function N(){f.value=v.value.reduce((n,e)=>n+e.price*e.quantity,0)}const F=async(n=1)=>{axios.get("/api/pdv/quicksell",{params:{query:j.value}}).then(e=>{D.value=e.data,L.value=e.data.total_consumed,q.value=e.data.categories,V.value=e.data.payment_methods,x.value=1,T.value=!1}).catch(e=>{T.value=!1,g.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),H()})},K=()=>{$.value=!0,axios.delete(`/api/tables/${M.value}`).then(()=>{D.value.data=D.value.data.filter(n=>n.id!==M.value),U(),g.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(n=>{g.add({severity:"error",summary:"Erro",detail:`${n}`,life:3e3}),$.value=!1}).finally(()=>{$.value=!1})},Y=ve(()=>{F(Q.value)},300);return ce(j,Y),pe(()=>{F()}),(n,e)=>{const c=ue,p=re,Z=ne,R=se,E=le,A=oe,I=ie,O=ae,S=te,z=ee;return s(),o(m,null,[T.value?(s(),o("div",fe,[t("div",_e,[t("div",be,[i(c,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[4]||(e[4]=t("p",null,"Por Favor Aguarde...",-1))])])])):(s(),o("div",ge,[t("div",ye,[t("div",he,[t("div",xe,[t("h2",null,[e[5]||(e[5]=k("Resumo da venda ")),f.value>0?(s(),o("div",ke,[t("strong",null,"Total: "+d(f.value)+" MT",1)])):B("",!0)]),(s(!0),o(m,null,b(v.value,(a,u)=>(s(),o("div",{key:u,class:"card bg-gray-100 p-4"},[t("div",null,[t("strong",null,d(a.name),1),t("button",{onClick:_=>J(u),class:"rounded-full bg-red-100",style:{width:"2.5rem",height:"2.5rem"}},"X",8,we)]),t("div",Ce,[t("div",null,d(a.quantity)+" x "+d(a.price)+" MT",1),t("div",null,d(a.price*a.quantity)+" MT",1)])]))),128)),f.value>0?(s(),o("div",Te,[i(p,{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=a=>x.value=a),options:V.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar"},null,8,["modelValue","options"]),t("strong",null,"Total: "+d(f.value)+" MT",1),t("button",{disabled:h.value,onClick:X,class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1",style:{width:"100%"}},e[6]||(e[6]=[k("Adicionar a conta"),t("i",{class:"pi pi-print"},null,-1)]),8,$e),h.value?(s(),o("div",De,[i(c,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])):B("",!0)])):B("",!0)])]),t("div",Pe,[t("div",qe,[i(Z,{model:W},{end:r(()=>[t("p",null,"Total Consumo: "+d(L.value)+" MT",1)]),_:1})]),t("div",Se,[i(O,{value:1},{default:r(()=>[i(E,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:r(()=>[(s(!0),o(m,null,b(q.value,a=>(s(),w(R,{key:a.id,value:a.id},{default:r(()=>[k(d(a.name),1)]),_:2},1032,["value"]))),128))]),_:1}),i(I,null,{default:r(()=>[(s(!0),o(m,null,b(q.value,a=>(s(),w(A,{key:a.id,value:a.id},{default:r(()=>[i(O,{value:0},{default:r(()=>[i(E,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:r(()=>[(s(!0),o(m,null,b(a.sub_categories,u=>(s(),w(R,{key:u.id,value:u.id},{default:r(()=>[k(d(u.name),1)]),_:2},1032,["value"]))),128))]),_:2},1024),i(I,null,{default:r(()=>[(s(!0),o(m,null,b(a.sub_categories,u=>(s(),w(A,{key:u.id,value:u.id},{default:r(()=>[u.products.length>0?(s(),o("div",Be,[t("div",Me,[(s(!0),o(m,null,b(u.products,_=>(s(),o("div",{key:_.id,class:"col-span-12 lg:col-span-6 xl:col-span-3"},[t("div",je,[t("div",Le,[t("img",{src:_.image_url||"/image/image.png",alt:"Imagem do Produto",class:"w-full h-32 object-cover rounded-t-lg"},null,8,Ve)]),t("div",Ue,[t("div",null,[t("div",Ne,d(_.name),1)])]),t("div",Fe,[t("span",Re,"Preço: "+d(_.price)+" MT",1)]),t("button",{onClick:Oe=>G(_),class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1"}," Adicionar ",8,Ee)])]))),128))])])):(s(),o("div",Ae,e[7]||(e[7]=[t("p",null,"No products available.",-1)])))]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])])])])),i(z,{header:"Confirmação",visible:P.value,"onUpdate:visible":e[1]||(e[1]=a=>P.value=a),style:{width:"350px"},modal:!0},{footer:r(()=>[i(S,{label:"Não",icon:"pi pi-times",onClick:U,class:"p-button-text"}),i(S,{label:"Sim",icon:"pi pi-check",onClick:K,class:"p-button-text",autofocus:""})]),default:r(()=>[e[8]||(e[8]=t("div",{class:"flex align-items-center justify-content-center"},[t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),t("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"]),i(z,{header:"Open File",visible:y.value,"onUpdate:visible":e[3]||(e[3]=a=>y.value=a),style:{width:"30vw"}},{default:r(()=>[e[9]||(e[9]=t("p",null,"Here you can manage your files or perform specific actions.",-1)),i(S,{label:"Close",onClick:e[2]||(e[2]=a=>y.value=!1)})]),_:1},8,["visible"])],64)}}};export{pt as default};
