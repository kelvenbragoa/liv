import{s as ye}from"./index-Dt5zQc2x.js";import{s as _e}from"./index-DoC7UYzi.js";import{s as ge}from"./index-BF2pvrn1.js";import{s as he,a as xe,b as we}from"./index-BxJmoQdL.js";import{s as ke,a as Ce}from"./index-CGDYbEYr.js";import{s as $e}from"./index-DlwLBsm6.js";import{s as Te}from"./index-BL8whLvU.js";import{u as De,r as s,w as Me,b as Pe,c as n,d as t,a as o,g as x,t as d,l as q,F as b,a1 as _,e as r,o as i,k as B,M as Re,aV as Ue,i as je}from"./app-Drk_5XQY.js";import{d as Se}from"./moment-CQ1ixRO1.js";import"./index-BF9E9MWy.js";import"./index-CcQDqxf6.js";import"./index-r8XGnFVE.js";import"./index-DAOrzEr_.js";import"./index-Ds2kJ9vy.js";import"./index-fdgYhkeD.js";import"./index-_pJHyPEn.js";import"./index-CR-CD_cW.js";import"./index-BgUkXx9t.js";import"./index-BiTvvaQ4.js";import"./index-f6DqpeBv.js";import"./index-oTLrlskW.js";const Ee={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},qe={class:"w-full"},Be={class:"flex flex-col gap-4 text-center"},Fe={key:1},Le={class:"grid grid-cols-12 gap-4 h-screen"},Ne={class:"col-span-12 lg:col-span-3 h-full"},Ve={class:"card flex flex-col gap-4 h-full"},Ae={key:0},Ie=["onClick"],Ze={class:"flex justify-between mb-4"},Oe={key:0,class:"mt-4"},We=["disabled"],ze={key:0,class:"flex flex-col gap-4 text-center"},He={class:"col-span-12 lg:col-span-9"},Qe={class:"mb-2"},Xe={class:"card flex flex-col gap-4"},Ge={key:0},Je={class:"grid grid-cols-12 gap-8"},Ke={class:"card mb-0 bg-gray-100"},Ye={class:"mb-4"},et=["src"],tt={class:"flex justify-between mb-4"},lt={class:"text-surface-900 dark:text-surface-0 font-medium text-xl"},at={class:"flex justify-between mb-4"},st={class:"text-primary font-medium"},ot=["onClick"],it={key:1},nt={class:"p-4"},dt={class:"space-y-2"},rt=["onClick"],ut={class:"mt-4 text-lg font-semibold"},ct={class:"text-blue-500"},pt={class:"mt-4 flex justify-end"},mt={class:"p-4"},vt={class:"mt-4 flex justify-end space-x-2"},ft={class:"p-4"},bt={class:"space-y-2"},yt={class:"mt-4 text-lg font-semibold"},_t={class:"text-blue-500"},gt={class:"mt-4 flex justify-end"},ht={class:"p-4"},xt={class:"space-y-2"},wt={class:"mt-4 text-lg font-semibold"},kt={class:"text-blue-500"},Ct={class:"mt-4 flex justify-end"},$t=["src"],Tt="13579",Gt={__name:"IndexPdvCategories",setup(Dt){const y=je(),u=De();s(null);const M=s(!0),F=s(!1);let Z=s(null);const O=s(""),P=s(null),te=s(1);s(15),s(0);const L=s(!1),R=s(null),w=s([]),k=s(0),C=s(0),m=s(!1),$=s([]),le=s(!1),T=s(1),N=s([]),W=s(null),V=s(null),U=s(!1),A=s(null),I=s(!1),j=s(!1),ae=s(!1),S=s(!1),E=s(!1),D=s(!1),se=[{label:"Consumo",items:[{label:"Ver consumo",icon:"pi pi-fw pi-folder-open",command:()=>{j.value=!0}},{label:"Imprimir Consumo",icon:"pi pi-fw pi-print",command:()=>{me()}}]},{label:"Conta",items:[{label:"Fechamento da Conta",icon:"pi pi-fw pi-lock",command:()=>{S.value=!0}},{label:"Finalizar da Conta",icon:"pi pi-fw pi-check",command:()=>{E.value=!0}}]}];function z(){y&&y.back()}const oe=a=>{W.value=a,D.value=!0},ie=()=>{if(V.value!==Tt){u.add({severity:"error",summary:"Erro",detail:"Código de confirmação inválido",life:3e3});return}else axios.post(`/api/orderitem/${W.value}`).then(a=>{P.value=a.data,C.value=a.data.total_consumed,R.value=a.data.categories,$.value=a.data.order_items,N.value=a.data.payment_methods,T.value=1,D.value=!1,u.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(a=>{u.add({severity:"error",summary:"Erro",detail:`${a}`,life:3e3})}).finally(()=>{})},H=()=>{L.value=!1};function ne(){const a={products:w.value.map(e=>({id:e.id,name:e.name,quantity:e.quantity,total:e.price*e.quantity})),total:k.value,table_id:y.currentRoute.value.params.id};m.value=!0,axios.post("/api/pdv",a,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob"}).then(e=>{y.back();const c=window.URL.createObjectURL(new Blob([e.data])),v=document.createElement("a");v.href=c,v.setAttribute("download","recibo.pdf"),document.body.appendChild(v),v.click(),le.value=!1,u.add({severity:"success",summary:"Successo",detail:"Produto encomedado sucesso!",life:3e3})}).catch(e=>{m.value=!1,u.add({severity:"error",summary:"Erro}",detail:`${e}`,life:3e3}),e.response.data.errors&&setErrors(e.response.data.errors)}).finally(()=>{m.value=!1})}function de(){m.value=!0,axios.get(`/api/pdv/closeaccount/${y.currentRoute.value.params.id}`,{responseType:"blob"}).then(a=>{const e=window.URL.createObjectURL(new Blob([a.data])),c=document.createElement("a");c.href=e,c.setAttribute("download","recibo.pdf"),document.body.appendChild(c),c.click(),S.value=!1,u.add({severity:"success",summary:"Successo",detail:"Encomenda fechada sucesso!",life:3e3})}).catch(a=>{m.value=!1,u.add({severity:"error",summary:"Erro}",detail:`${a}`,life:3e3}),a.response.data.errors&&setErrors(a.response.data.errors)}).finally(()=>{m.value=!1})}function re(){const a={payment_method_id:T.value,table_id:y.currentRoute.value.params.id};m.value=!0,axios.post("/api/payaccount",a,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob"}).then(e=>{y.back();const c=window.URL.createObjectURL(new Blob([e.data])),v=document.createElement("a");v.href=c,v.setAttribute("download","recibo.pdf"),document.body.appendChild(v),v.click(),E.value=!1,u.add({severity:"success",summary:"Successo",detail:"Encomenda fechada sucesso!",life:3e3})}).catch(e=>{m.value=!1,u.add({severity:"error",summary:"Erro}",detail:`${e}`,life:3e3}),e.response.data.errors&&setErrors(e.response.data.errors)}).finally(()=>{m.value=!1})}function ue(a){const e=w.value.find(c=>c.id===a.id);e?e.quantity+=1:w.value.push({...a,quantity:1}),Q()}function ce(a){w.value.splice(a,1),Q()}function Q(){k.value=w.value.reduce((a,e)=>a+e.price*e.quantity,0)}function pe(){const a=document.querySelector("iframe");a&&(a.contentWindow.focus(),a.contentWindow.print())}function me(){axios.post(`/api/getreceipt/${y.currentRoute.value.params.id}`,{},{responseType:"blob"}).then(a=>{const e=new Blob([a.data],{type:"application/pdf"});A.value=URL.createObjectURL(e),U.value=!0,ae.value=!1,u.add({severity:"success",summary:"Successo",detail:"Consumo Impresso com sucesso!",life:3e3})}).catch(a=>{M.value=!1,u.add({severity:"error",summary:`${a}`,detail:"Message Detail",life:3e3}),z()})}const X=async(a=1)=>{axios.get(`/api/pdv/${y.currentRoute.value.params.id}`,{params:{query:O.value}}).then(e=>{P.value=e.data,C.value=e.data.total_consumed,R.value=e.data.categories,$.value=e.data.order_items,N.value=e.data.payment_methods,T.value=1,M.value=!1}).catch(e=>{M.value=!1,u.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),z()})},ve=()=>{F.value=!0,axios.delete(`/api/tables/${Z.value}`).then(()=>{P.value.data=P.value.data.filter(a=>a.id!==Z.value),H(),u.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(a=>{u.add({severity:"error",summary:"Erro",detail:`${a}`,life:3e3}),F.value=!1}).finally(()=>{F.value=!1})},fe=Se(()=>{X(te.value)},300);return Me(O,fe),Pe(()=>{X()}),(a,e)=>{const c=Te,v=$e,G=xe,J=we,K=ke,Y=Ce,ee=he,f=ge,g=_e,be=ye;return i(),n(b,null,[M.value?(i(),n("div",Ee,[t("div",qe,[t("div",Be,[o(c,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[15]||(e[15]=t("p",null,"Por Favor Aguarde...",-1))])])])):(i(),n("div",Fe,[t("div",Le,[t("div",Ne,[t("div",Ve,[t("h2",null,[e[16]||(e[16]=x("Resumo da venda ")),k.value>0?(i(),n("div",Ae,[t("strong",null,"Total: "+d(k.value)+" MT",1)])):q("",!0)]),(i(!0),n(b,null,_(w.value,(l,p)=>(i(),n("div",{key:p,class:"card bg-gray-100 p-4"},[t("div",null,[t("strong",null,d(l.name),1),t("button",{onClick:h=>ce(p),class:"rounded-full bg-red-100",style:{width:"2.5rem",height:"2.5rem"}},"X",8,Ie)]),t("div",Ze,[t("div",null,d(l.quantity)+" x "+d(l.price)+" MT",1),t("div",null,d(l.price*l.quantity)+" MT",1)])]))),128)),k.value>0?(i(),n("div",Oe,[t("strong",null,"Total: "+d(k.value)+" MT",1),t("button",{disabled:m.value,onClick:ne,class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1",style:{width:"100%"}},e[17]||(e[17]=[x("Adicionar a conta"),t("i",{class:"pi pi-print"},null,-1)]),8,We),m.value?(i(),n("div",ze,[o(c,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])):q("",!0)])):q("",!0)])]),t("div",He,[t("div",Qe,[o(v,{model:se},{end:r(()=>[t("p",null,"Total Consumo: "+d(C.value)+" MT",1)]),_:1})]),t("div",Xe,[o(ee,{value:1},{default:r(()=>[o(J,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:r(()=>[(i(!0),n(b,null,_(R.value,l=>(i(),B(G,{key:l.id,value:l.id},{default:r(()=>[x(d(l.name),1)]),_:2},1032,["value"]))),128))]),_:1}),o(Y,null,{default:r(()=>[(i(!0),n(b,null,_(R.value,l=>(i(),B(K,{key:l.id,value:l.id},{default:r(()=>[o(ee,{value:0},{default:r(()=>[o(J,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:r(()=>[(i(!0),n(b,null,_(l.sub_categories,p=>(i(),B(G,{key:p.id,value:p.id},{default:r(()=>[x(d(p.name),1)]),_:2},1032,["value"]))),128))]),_:2},1024),o(Y,null,{default:r(()=>[(i(!0),n(b,null,_(l.sub_categories,p=>(i(),B(K,{key:p.id,value:p.id},{default:r(()=>[p.products.length>0?(i(),n("div",Ge,[t("div",Je,[(i(!0),n(b,null,_(p.products,h=>(i(),n("div",{key:h.id,class:"col-span-12 lg:col-span-6 xl:col-span-3"},[t("div",Ke,[t("div",Ye,[t("img",{src:h.image?`/${h.image}`:"/image/image.png",alt:"Imagem do Produto",class:"w-full h-32 rounded-t-lg"},null,8,et)]),t("div",tt,[t("div",null,[t("div",lt,d(h.name),1)])]),t("div",at,[t("span",st,"Preço: "+d(h.price)+" MT",1)]),t("button",{onClick:Mt=>ue(h),class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1"}," Adicionar ",8,ot)])]))),128))])])):(i(),n("div",it,e[18]||(e[18]=[t("p",null,"No products available.",-1)])))]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])])])])),o(g,{header:"Confirmação",visible:L.value,"onUpdate:visible":e[0]||(e[0]=l=>L.value=l),style:{width:"350px"},modal:!0},{footer:r(()=>[o(f,{label:"Não",icon:"pi pi-times",onClick:H,class:"p-button-text"}),o(f,{label:"Sim",icon:"pi pi-check",onClick:ve,class:"p-button-text",autofocus:""})]),default:r(()=>[e[19]||(e[19]=t("div",{class:"flex align-items-center justify-content-center"},[t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),t("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"]),o(g,{header:"Open File",visible:I.value,"onUpdate:visible":e[2]||(e[2]=l=>I.value=l),style:{width:"30vw"}},{default:r(()=>[e[20]||(e[20]=t("p",null,"Here you can manage your files or perform specific actions.",-1)),o(f,{label:"Close",onClick:e[1]||(e[1]=l=>I.value=!1)})]),_:1},8,["visible"]),o(g,{header:"Consumo da Mesa",visible:j.value,"onUpdate:visible":e[4]||(e[4]=l=>j.value=l),style:{width:"30vw"}},{default:r(()=>[t("div",nt,[e[22]||(e[22]=t("h3",{class:"text-lg font-bold mb-4"},"Detalhes do Pedido",-1)),t("ul",dt,[(i(!0),n(b,null,_($.value,l=>(i(),n("li",{key:l.id,class:"flex justify-between border-b pb-2 mt-5"},[t("span",null,d(l.quantity)+" x "+d(l.product.name),1),t("span",null,[x("MZN "+d(l.total)+" ",1),t("i",{class:"pi pi-trash",onClick:p=>oe(l.id)},null,8,rt)])]))),128))]),t("p",ut,[e[21]||(e[21]=t("span",null,"Total: ",-1)),t("span",ct,"MZN "+d(C.value),1)]),t("div",pt,[o(f,{label:"Fechar",onClick:e[3]||(e[3]=l=>j.value=!1),class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-4 py-2 rounded"})])])]),_:1},8,["visible"]),o(g,{header:"Confirmar Exclusão",visible:D.value,"onUpdate:visible":e[7]||(e[7]=l=>D.value=l),style:{width:"20vw"}},{default:r(()=>[t("div",mt,[e[23]||(e[23]=t("p",{class:"mb-4"},[x("Insira o código para confirmar a exclusão do item "),t("strong"),x(".")],-1)),Re(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>V.value=l),type:"password",placeholder:"Código de confirmação",class:"w-full p-2 border rounded"},null,512),[[Ue,V.value]]),t("div",vt,[o(f,{label:"Cancelar",onClick:e[6]||(e[6]=l=>D.value=!1),class:"bg-gray-300 hover:bg-gray-400 text-black font-semibold px-4 py-2 rounded"}),o(f,{label:"Confirmar",onClick:ie,class:"bg-red-500 hover:bg-red-600 text-white font-semibold px-4 py-2 rounded"})])])]),_:1},8,["visible"]),o(g,{header:"Fechar a conta",visible:S.value,"onUpdate:visible":e[9]||(e[9]=l=>S.value=l),style:{width:"30vw"}},{default:r(()=>[t("div",ft,[e[25]||(e[25]=t("h3",{class:"text-lg font-bold mb-4"},"Detalhes do Pedido",-1)),t("ul",bt,[(i(!0),n(b,null,_($.value,l=>(i(),n("li",{key:l.id,class:"flex justify-between border-b pb-2 mt-5"},[t("span",null,d(l.quantity)+" x "+d(l.product.name),1),t("span",null,"MZN "+d(l.total),1)]))),128))]),t("p",yt,[e[24]||(e[24]=t("span",null,"Total: ",-1)),t("span",_t,"MZN "+d(C.value),1)]),t("div",gt,[o(f,{label:"Fechar Conta",onClick:e[8]||(e[8]=l=>de()),class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-4 py-2 rounded"})])])]),_:1},8,["visible"]),o(g,{header:"Fechar a conta",visible:E.value,"onUpdate:visible":e[12]||(e[12]=l=>E.value=l),style:{width:"30vw"}},{default:r(()=>[t("div",ht,[e[27]||(e[27]=t("h3",{class:"text-lg font-bold mb-4"},"Detalhes do Pedido",-1)),t("ul",xt,[(i(!0),n(b,null,_($.value,l=>(i(),n("li",{key:l.id,class:"flex justify-between border-b pb-2 mt-5"},[t("span",null,d(l.quantity)+" x "+d(l.product.name),1),t("span",null,"MZN "+d(l.total),1)]))),128))]),o(be,{modelValue:T.value,"onUpdate:modelValue":e[10]||(e[10]=l=>T.value=l),options:N.value,optionLabel:"name",optionValue:"id",class:"mt-2",placeholder:"Selecionar"},null,8,["modelValue","options"]),t("p",wt,[e[26]||(e[26]=t("span",null,"Total: ",-1)),t("span",kt,"MZN "+d(C.value),1)]),t("div",Ct,[o(f,{label:"Pagar a Conta",onClick:e[11]||(e[11]=l=>re()),class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-4 py-2 rounded"})])])]),_:1},8,["visible"]),o(g,{visible:U.value,"onUpdate:visible":e[14]||(e[14]=l=>U.value=l),header:"Recibo",modal:!0,style:{width:"600px"}},{footer:r(()=>[o(f,{label:"Imprimir",icon:"pi pi-print",onClick:pe}),o(f,{label:"Fechar",icon:"pi pi-times",class:"p-button-text",onClick:e[13]||(e[13]=l=>U.value=!1)})]),default:r(()=>[A.value?(i(),n("iframe",{key:0,src:A.value,style:{width:"100%",height:"500px"},frameborder:"0"},null,8,$t)):q("",!0)]),_:1},8,["visible"])],64)}}};export{Gt as default};
