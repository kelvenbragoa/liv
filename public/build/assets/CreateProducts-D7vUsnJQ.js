import{s as G}from"./index-B7BclkKh.js";import{s as H}from"./index-DX9bqo8B.js";import{s as J}from"./index-RKdquAb9.js";import{s as K}from"./index-CkvTDcOt.js";import{s as X}from"./index-aEfoq-ac.js";import{u as Y,r as s,w as Z,d as ee,c as w,b as a,a as i,e as B,f as l,j as p,n as f,t as v,k as ae,l as se,F as le,i as oe,o as g,g as te}from"./app-D9TxNh-u.js";import{u as ie}from"./vee-validate-CqzzJO4b.js";import{d as re}from"./moment-CQ1ixRO1.js";import{c as ne,a as b}from"./index.esm-CQT6nZnd.js";import"./index-Cwtv0tSG.js";import"./index-8C1OQYHK.js";import"./index-iBYJyT99.js";import"./index-C5jbZ7EA.js";import"./index-DKM6o7KP.js";import"./index-BKn3ZtJ0.js";const de={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},ue={class:"w-full"},ce={class:"flex flex-col gap-4 text-center"},me={key:1,class:"flex flex-col md:flex-row gap-12"},pe={class:"w-full"},fe={class:"card flex flex-col gap-4"},ve={class:"w-full"},ge={class:"flex flex-col gap-2"},be={id:"name-help",class:"p-error"},_e={class:"flex flex-col gap-2"},ye={id:"price-help",class:"p-error"},xe={class:"flex flex-col gap-2"},Ve={id:"category_id-help",class:"p-error"},he={class:"flex flex-col gap-2"},ke={id:"sub_category_id-help",class:"p-error"},Re={__name:"CreateProducts",setup(Ce){const _=oe(),n=Y();s(null);const y=s(!0),x=s(!1);let $=s(null);const M=s(""),V=s(null),R=s(1);s(15),s(0);const h=s(!1),N=s(null),q=s(null),k=s(null),d=s(!1),W=ne({category_id:b().required().trim().label("Categoria"),name:b().required().trim().label("Name"),price:b().required().trim().label("Preco"),sub_category_id:b().required().trim().label("Name")}),{defineField:u,handleSubmit:A,resetForm:Se,errors:r,setErrors:I}=ie({validationSchema:W}),[c]=u("category_id"),[C]=u("sub_category_id"),[S]=u("price"),[P]=u("name"),F=s();function U(){_&&_.back()}const T=()=>{h.value=!1},D=A(o=>{F.value!=null&&(o.image=F.value),d.value=!0,axios.post("/api/products",o,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{_.back(),n.add({severity:"success",summary:"Successo",detail:"Produto criado com sucesso",life:3e3})}).catch(e=>{d.value=!1,n.add({severity:"error",summary:"Erro}",detail:`${e.response.data.message}`,life:3e3}),e.response.data.errors&&I(e.response.data.errors)}).finally(()=>{d.value=!1})}),j=async(o=1)=>{axios.get("/api/products/create",{params:{query:M.value}}).then(e=>{V.value=e.data.categories,N.value=e.data.categories,q.value=e.data.sub_categories,y.value=!1}).catch(e=>{y.value=!1,n.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),U()})},O=()=>{x.value=!0,axios.delete(`/api/products/${$.value}`).then(()=>{V.value.data=V.value.data.filter(o=>o.id!==$.value),T(),n.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(o=>{n.add({severity:"error",summary:"Erro",detail:`${o}`,life:3e3}),x.value=!1}).finally(()=>{x.value=!1})};return re(()=>{j(R.value)},300),Z(c,o=>{o?k.value=q.value.filter(e=>e.category_id===o):k.value=[]}),ee(()=>{j()}),(o,e)=>{const E=X,m=K,L=J,z=H,Q=G;return g(),w(le,null,[y.value?(g(),w("div",de,[a("div",ue,[a("div",ce,[i(E,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[6]||(e[6]=a("p",null,"Por Favor Aguarde...",-1))])])])):(g(),w("div",me,[a("div",pe,[a("div",fe,[a("div",ve,[i(m,{label:"Voltar",class:"mr-2 mb-2",onClick:U},{default:B(()=>e[7]||(e[7]=[a("i",{class:"pi pi-angle-left"},null,-1),te(" Voltar")])),_:1})]),e[12]||(e[12]=a("div",{class:"font-semibold text-xl"},"Produto",-1)),e[13]||(e[13]=a("small",{class:"p-error"},"Os campos marcados * sao considerados campos obrigatorios.",-1)),a("form",{onSubmit:e[4]||(e[4]=(...t)=>l(D)&&l(D)(...t))},[a("div",ge,[e[8]||(e[8]=a("label",{for:"name1"},"Nome",-1)),i(L,{modelValue:l(P),"onUpdate:modelValue":e[0]||(e[0]=t=>p(P)?P.value=t:null),id:"name",placeholder:"Nome da Produto",class:f({"p-invalid":l(r).name}),type:"text"},null,8,["modelValue","class"]),a("small",be,v(l(r).name),1)]),a("div",_e,[e[9]||(e[9]=a("label",{for:"name1"},"Preço",-1)),i(L,{modelValue:l(S),"onUpdate:modelValue":e[1]||(e[1]=t=>p(S)?S.value=t:null),id:"price",placeholder:"Preço",class:f({"p-invalid":l(r).price}),type:"number"},null,8,["modelValue","class"]),a("small",ye,v(l(r).price),1)]),a("div",xe,[e[10]||(e[10]=a("label",{for:"name1"},"Categoria",-1)),i(z,{modelValue:l(c),"onUpdate:modelValue":e[2]||(e[2]=t=>p(c)?c.value=t:null),options:N.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar",class:f({"p-invalid":l(r).category_id})},null,8,["modelValue","options","class"]),a("small",Ve,v(l(r).category_id),1)]),a("div",he,[e[11]||(e[11]=a("label",{for:"name1"},"SubCategoria",-1)),i(z,{modelValue:l(C),"onUpdate:modelValue":e[3]||(e[3]=t=>p(C)?C.value=t:null),options:k.value,optionLabel:"name",optionValue:"id",placeholder:"Selecionar",class:f({"p-invalid":l(r).sub_category_id})},null,8,["modelValue","options","class"]),a("small",ke,v(l(r).sub_category_id),1)]),i(m,{label:"Submeter",class:"mr-2 mb-2",onClick:l(D),disabled:d.value},null,8,["onClick","disabled"]),d.value?(g(),ae(E,{key:0,style:{width:"35px",height:"35px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})):se("",!0)],32)])])])),i(Q,{header:"Confirmação",visible:h.value,"onUpdate:visible":e[5]||(e[5]=t=>h.value=t),style:{width:"350px"},modal:!0},{footer:B(()=>[i(m,{label:"Não",icon:"pi pi-times",onClick:T,class:"p-button-text"}),i(m,{label:"Sim",icon:"pi pi-check",onClick:O,class:"p-button-text",autofocus:""})]),default:B(()=>[e[14]||(e[14]=a("div",{class:"flex align-items-center justify-content-center"},[a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),a("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"])],64)}}};export{Re as default};
