import{s as q}from"./index-BiHTuues.js";import{s as I}from"./index-ondRFn1A.js";import{s as G}from"./index-CyTT0Vwr.js";import{s as K}from"./index-h0r2UH-j.js";import{s as O}from"./index-BszRTn-I.js";import{s as Q}from"./index-DZp2ByZM.js";import{s as W}from"./index-CKMdMxEn.js";import{u as J,r as o,w as X,o as Z,c as h,a as e,b as a,e as r,d as s,t as u,g as Y,F as tt,f as C,k as et}from"./app-BOyYmBzo.js";import{d as at,h as R}from"./moment-CQ1ixRO1.js";import"./index-Cc1UoU5f.js";import"./index-CkryDDHF.js";import"./index-BXRDs3kp.js";import"./index-BoNlvawM.js";import"./index-CiLCGkO0.js";import"./index-DiwBnWPK.js";import"./index-D9ivNX4o.js";import"./index-B5V1ONCG.js";import"./index-CRM2fMZb.js";import"./index-CML5C4T5.js";import"./index-1HcuzsbS.js";import"./index-CgxObtEZ.js";import"./index-D4iFNsOV.js";import"./index-CJq0LAY_.js";import"./index-w_o5PfkI.js";import"./index-7eUFddD6.js";import"./index-CTi1xqL8.js";import"./index-Ctrez2Wv.js";const ot={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},st={class:"w-full"},lt={class:"flex flex-col gap-4 text-center"},rt={key:1,class:"flex flex-col md:flex-row gap-12"},nt={class:"w-full"},it={class:"card flex flex-col gap-4"},ut={class:"w-full"},dt={class:"card"},Ft={__name:"ShowTables",setup(mt){const f=et(),v=J();o(null);const c=o(!0),g=o(!1);let k=o(null);const D=o(""),i=o(null),M=o(null),p=o(1),y=o(15),S=o(0),b=o(!1),x=o({labels:[],datasets:[{label:"Consumo Mensal",backgroundColor:"#42A5F5",data:[]}]}),P=getComputedStyle(document.documentElement),V=P.getPropertyValue("--surface-border"),$=P.getPropertyValue("--text-color-secondary"),A={maintainAspectRatio:!1,aspectRatio:.8,scales:{x:{stacked:!0,ticks:{color:$.trim()},grid:{color:"transparent",borderColor:"transparent"}},y:{stacked:!0,ticks:{color:$.trim()},grid:{color:V.trim(),borderColor:"transparent",drawTicks:!1}}}};function T(){f&&f.back()}const B=()=>{b.value=!1};function L(n){switch(n){case 1:return"success";case 2:return"danger";case 3:return"warn";case 4:return"danger";case 5:return"info";case 6:return"info"}}const w=async(n=1)=>{axios.get(`/api/tables/${f.currentRoute.value.params.id}`,{params:{query:D.value}}).then(t=>{i.value=t.data.table,M.value=t.data.logs,S.value=t.data.logs.total,x.value.labels=t.data.chart.map(d=>d.month_name),x.value.datasets[0].data=t.data.chart.map(d=>d.total),c.value=!1}).catch(t=>{c.value=!1,v.add({severity:"error",summary:`${t}`,detail:"Message Detail",life:3e3}),T()})},N=()=>{g.value=!0,axios.delete(`/api/tables/${k.value}`).then(()=>{i.value.data=i.value.data.filter(n=>n.id!==k.value),B(),v.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(n=>{v.add({severity:"error",summary:"Erro",detail:`${n}`,life:3e3}),g.value=!1}).finally(()=>{g.value=!1})},E=n=>{p.value=n.page+1,y.value=n.rows,w(p.value)},F=at(()=>{w(p.value)},300);return X(D,F),Z(()=>{w()}),(n,t)=>{const d=W,_=Q,j=O,z=K,m=G,H=I,U=q;return C(),h(tt,null,[c.value?(C(),h("div",ot,[e("div",st,[e("div",lt,[a(d,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),t[1]||(t[1]=e("p",null,"Por Favor Aguarde...",-1))])])])):(C(),h("div",rt,[e("div",nt,[e("div",it,[e("div",ut,[a(_,{label:"Voltar",class:"mr-2 mb-2",onClick:T},{default:r(()=>t[2]||(t[2]=[e("i",{class:"pi pi-angle-left"},null,-1),s(" Voltar")])),_:1})]),t[11]||(t[11]=e("div",{class:"font-semibold text-xl"},"Mesa",-1)),e("p",null,[t[3]||(t[3]=e("strong",null,"Mesa:",-1)),s(" "+u(i.value.name),1)]),e("p",null,[t[4]||(t[4]=e("strong",null,"Capacidade:",-1)),s(" "+u(i.value.capacity),1)]),e("p",null,[t[5]||(t[5]=e("strong",null,"Limite Mensal:",-1)),s(" "+u(i.value.monthly_limit)+" MT ",1)]),e("p",null,[t[6]||(t[6]=e("strong",null,"Estado:",-1)),a(j,{value:i.value.status.name,severity:L(i.value.status_id)},null,8,["value","severity"])]),e("p",null,[t[7]||(t[7]=e("strong",null,"Data:",-1)),s(" "+u(Y(R)(i.value.created_at).format("DD-MM-YYYY H:mm")),1)]),t[12]||(t[12]=e("hr",null,null,-1)),e("div",dt,[t[8]||(t[8]=e("div",{class:"font-semibold text-xl mb-4"},"Consumo Mensal",-1)),a(z,{type:"bar",data:x.value,options:A,class:"h-80"},null,8,["data"])]),t[13]||(t[13]=e("hr",null,null,-1)),a(H,{value:M.value.data,paginator:!0,rows:y.value,totalRecords:S.value,dataKey:"id",lazy:!0,rowHover:!0,loading:c.value,first:(p.value-1)*y.value,onPage:E,showGridlines:""},{empty:r(()=>t[9]||(t[9]=[s("Nenhuma registro encontrado. ")])),loading:r(()=>t[10]||(t[10]=[s(" Carregando, por favor espere. ")])),default:r(()=>[a(m,{header:"ID",style:{"min-width":"12rem"}},{body:r(({data:l})=>[s(u(l.id),1)]),_:1}),a(m,{header:"Limite Anterior",style:{"min-width":"12rem"}},{body:r(({data:l})=>[s(u(l.old_limit),1)]),_:1}),a(m,{header:"Limite Atual",style:{"min-width":"12rem"}},{body:r(({data:l})=>[s(u(l.new_limit),1)]),_:1}),a(m,{header:"Usuario",style:{"min-width":"12rem"}},{body:r(({data:l})=>[s(u(l.user.name),1)]),_:1}),a(m,{header:"Data",dataType:"date",style:{"min-width":"10rem"}},{body:r(({data:l})=>[s(u(Y(R)(l.created_at).format("DD-MM-YYYY H:mm")),1)]),_:1})]),_:1},8,["value","rows","totalRecords","loading","first"])])])])),a(U,{header:"Confirmação",visible:b.value,"onUpdate:visible":t[0]||(t[0]=l=>b.value=l),style:{width:"350px"},modal:!0},{footer:r(()=>[a(_,{label:"Não",icon:"pi pi-times",onClick:B,class:"p-button-text"}),a(_,{label:"Sim",icon:"pi pi-check",onClick:N,class:"p-button-text",autofocus:""})]),default:r(()=>[t[14]||(t[14]=e("div",{class:"flex align-items-center justify-content-center"},[e("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),e("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"])],64)}}};export{Ft as default};
