import{s as H}from"./index-CT_lo015.js";import{s as J}from"./index-DXPuTS8v.js";import{s as K,a as O,b as Y}from"./index-CYLdLTUo.js";import{s as Z,a as ee}from"./index-BXLZUxKT.js";import{s as te}from"./index-D4aGl0mq.js";import{u as ae,r as i,w as se,d as le,c as l,b as t,a as u,g as y,t as d,l as P,F as c,N as m,e as n,o as a,k as b,i as oe}from"./app-BUUgi4zj.js";import{d as ie}from"./moment-CQ1ixRO1.js";import"./index-CTFHRYau.js";import"./index-Bglzde4G.js";import"./index-B91hPQg3.js";import"./index-fPEIEAJz.js";import"./index-zg1Vg8oW.js";const ne={key:0,class:"flex flex-col md:flex-row gap-12 min-h-screen items-center justify-center"},re={class:"w-full"},ue={class:"flex flex-col gap-4 text-center"},de={key:1},ce={class:"grid grid-cols-12 gap-4 h-screen"},pe={class:"col-span-12 lg:col-span-3 h-full"},ve={class:"card flex flex-col gap-4 h-full"},fe={key:0},me=["onClick"],_e={class:"flex justify-between mb-4"},ge={key:0,class:"mt-4"},he=["disabled"],xe={key:0,class:"flex flex-col gap-4 text-center"},ye={class:"col-span-12 lg:col-span-9"},be={class:"card flex flex-col gap-4"},ke={key:0},Ce={class:"grid grid-cols-12 gap-8"},we={class:"card mb-0 bg-gray-100"},Te={class:"mb-4"},$e=["src"],Pe={class:"flex justify-between mb-4"},De={class:"text-surface-900 dark:text-surface-0 font-medium text-xl"},qe={class:"flex justify-between mb-4"},Be={class:"text-primary font-medium"},Se=["onClick"],je={key:1},Ge={__name:"IndexPdvCategories",setup(Me){const h=oe(),_=ae();i(null);const k=i(!0),C=i(!1);let D=i(null);const q=i(""),w=i(null),V=i(1);i(15);const A=i(0),T=i(!1),$=i(null),p=i([]),v=i(0),g=i(!1);function I(){h&&h.back()}const B=()=>{T.value=!1};function z(){const o={products:p.value.map(e=>({id:e.id,name:e.name,quantity:e.quantity,total:e.price*e.quantity})),total:v.value,table_id:h.currentRoute.value.params.id};g.value=!0,axios.post("/api/pdv",o,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{_.add({severity:"success",summary:"Successo",detail:"Produto encomedado sucesso!",life:3e3})}).catch(e=>{g.value=!1,_.add({severity:"error",summary:"Erro}",detail:`${e.response.data.message}`,life:3e3}),e.response.data.errors&&setErrors(e.response.data.errors)}).finally(()=>{g.value=!1})}function U(o){const e=p.value.find(x=>x.id===o.id);e?e.quantity+=1:p.value.push({...o,quantity:1}),S()}function W(o){p.value.splice(o,1),S()}function S(){v.value=p.value.reduce((o,e)=>o+e.price*e.quantity,0)}const j=async(o=1)=>{axios.get(`/api/pdv/${h.currentRoute.value.params.id}`,{params:{query:q.value}}).then(e=>{w.value=e.data,A.value=e.data.total,$.value=e.data.categories,k.value=!1}).catch(e=>{k.value=!1,_.add({severity:"error",summary:`${e}`,detail:"Message Detail",life:3e3}),I()})},Q=()=>{C.value=!0,axios.delete(`/api/tables/${D.value}`).then(()=>{w.value.data=w.value.data.filter(o=>o.id!==D.value),B(),_.add({severity:"success",summary:"Sucesso",detail:"Sucesso ao apagar",life:3e3})}).catch(o=>{_.add({severity:"error",summary:"Erro",detail:`${o}`,life:3e3}),C.value=!1}).finally(()=>{C.value=!1})},X=ie(()=>{j(V.value)},300);return se(q,X),le(()=>{j()}),(o,e)=>{const x=te,M=O,N=Y,R=Z,E=ee,F=K,L=J,G=H;return a(),l(c,null,[k.value?(a(),l("div",ne,[t("div",re,[t("div",ue,[u(x,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"}),e[1]||(e[1]=t("p",null,"Por Favor Aguarde...",-1))])])])):(a(),l("div",de,[t("div",ce,[t("div",pe,[t("div",ve,[t("h2",null,[e[2]||(e[2]=y("Resumo da venda ")),v.value>0?(a(),l("div",fe,[t("strong",null,"Total: "+d(v.value)+" MT",1)])):P("",!0)]),(a(!0),l(c,null,m(p.value,(s,r)=>(a(),l("div",{key:r,class:"card bg-gray-100 p-4"},[t("div",null,[t("strong",null,d(s.name),1),t("button",{onClick:f=>W(r),class:"rounded-full bg-red-100",style:{width:"2.5rem",height:"2.5rem"}},"X",8,me)]),t("div",_e,[t("div",null,d(s.quantity)+" x "+d(s.price)+" MT",1),t("div",null,d(s.price*s.quantity)+" MT",1)])]))),128)),v.value>0?(a(),l("div",ge,[t("strong",null,"Total: "+d(v.value)+" MT",1),t("button",{disabled:g.value,onClick:z,class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1",style:{width:"100%"}},e[3]||(e[3]=[y("Adicionar a conta"),t("i",{class:"pi pi-print"},null,-1)]),8,he),g.value?(a(),l("div",xe,[u(x,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])):P("",!0)])):P("",!0)])]),t("div",ye,[t("div",be,[u(F,{value:1},{default:n(()=>[u(N,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:n(()=>[(a(!0),l(c,null,m($.value,s=>(a(),b(M,{key:s.id,value:s.id},{default:n(()=>[y(d(s.name),1)]),_:2},1032,["value"]))),128))]),_:1}),u(E,null,{default:n(()=>[(a(!0),l(c,null,m($.value,s=>(a(),b(R,{key:s.id,value:s.id},{default:n(()=>[u(F,{value:0},{default:n(()=>[u(N,{class:"flex overflow-x-auto space-x-4 pb-2"},{default:n(()=>[(a(!0),l(c,null,m(s.sub_categories,r=>(a(),b(M,{key:r.id,value:r.id},{default:n(()=>[y(d(r.name),1)]),_:2},1032,["value"]))),128))]),_:2},1024),u(E,null,{default:n(()=>[(a(!0),l(c,null,m(s.sub_categories,r=>(a(),b(R,{key:r.id,value:r.id},{default:n(()=>[r.products.length>0?(a(),l("div",ke,[t("div",Ce,[(a(!0),l(c,null,m(r.products,f=>(a(),l("div",{key:f.id,class:"col-span-12 lg:col-span-6 xl:col-span-3"},[t("div",we,[t("div",Te,[t("img",{src:f.image_url||"/image/image.png",alt:"Imagem do Produto",class:"w-full h-32 object-cover rounded-t-lg"},null,8,$e)]),t("div",Pe,[t("div",null,[t("div",De,d(f.name),1)])]),t("div",qe,[t("span",Be,"Preço: "+d(f.price)+" MT",1)]),t("button",{onClick:Ne=>U(f),class:"bg-blue-500 text-white px-4 py-2 rounded-full mt-1"}," Adicionar ",8,Se)])]))),128))])])):(a(),l("div",je,e[4]||(e[4]=[t("p",null,"No products available.",-1)])))]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])])])])),u(G,{header:"Confirmação",visible:T.value,"onUpdate:visible":e[0]||(e[0]=s=>T.value=s),style:{width:"350px"},modal:!0},{footer:n(()=>[u(L,{label:"Não",icon:"pi pi-times",onClick:B,class:"p-button-text"}),u(L,{label:"Sim",icon:"pi pi-check",onClick:Q,class:"p-button-text",autofocus:""})]),default:n(()=>[e[5]||(e[5]=t("div",{class:"flex align-items-center justify-content-center"},[t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),t("span",null,"Tem certeza que deseja proceder?")],-1))]),_:1},8,["visible"])],64)}}};export{Ge as default};
